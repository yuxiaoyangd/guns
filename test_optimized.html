<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼˜åŒ–ç‰ˆè°ƒè¯•æ¸¸æˆæµ‹è¯•</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        
        .header {
            background: #2C3E50;
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .game-info {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .game-canvas {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: 400px;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        button {
            background: #27AE60;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #229954;
        }
        
        .status {
            background: #E8F5E8;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .code-info {
            background: #F8F9FA;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #007BFF;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”§ ä¼˜åŒ–ç‰ˆè°ƒè¯•æ¸¸æˆæµ‹è¯•</h1>
        <p>ç®€åŒ–ä»£ç ç»“æ„ï¼Œåˆ é™¤æ— ç”¨é€»è¾‘ï¼Œä¿æŒæ¸¸æˆåŠŸèƒ½</p>
    </div>
    
    <div class="container">
        <div class="game-info">
            <h2>ğŸ“Š ä¼˜åŒ–è¯´æ˜</h2>
            <div class="code-info">
                <strong>ä¸»è¦ä¼˜åŒ–ï¼š</strong>
                <ul>
                    <li>âœ… åˆ é™¤å¤æ‚çš„Canvasæ·»åŠ é€»è¾‘ï¼Œä½¿ç”¨ç®€å•ç›´æ¥çš„æ–¹æ³•</li>
                    <li>âœ… ç®€åŒ–è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼Œç»Ÿä¸€è§¦æ‘¸å’Œé¼ æ ‡äº‹ä»¶</li>
                    <li>âœ… åˆ é™¤æ— ç”¨çš„é”™è¯¯å¤„ç†å’Œå¤‡ç”¨æ–¹æ¡ˆ</li>
                    <li>âœ… ç®€åŒ–éŸ³é¢‘ç¦ç”¨é€»è¾‘</li>
                    <li>âœ… åˆ é™¤å†—ä½™çš„è°ƒè¯•ä»£ç </li>
                    <li>âœ… ä¿æŒæ ¸å¿ƒæ¸¸æˆåŠŸèƒ½ä¸å˜</li>
                </ul>
            </div>
            <div class="status">
                <strong>çŠ¶æ€:</strong> <span id="gameStatus">åˆå§‹åŒ–ä¸­...</span>
            </div>
        </div>
        
        <div class="game-canvas">
            <!-- æ¸¸æˆCanvaså°†åœ¨è¿™é‡Œåˆ›å»º -->
        </div>
        
        <div class="controls">
            <h3>ğŸ® æ§åˆ¶é¢æ¿</h3>
            <button onclick="restartGame()">ğŸ”„ é‡å¯æ¸¸æˆ</button>
            <button onclick="switchVersion()">ğŸ”„ åˆ‡æ¢ç‰ˆæœ¬</button>
            <button onclick="clearConsole()">ğŸ§¹ æ¸…ç©ºæ§åˆ¶å°</button>
            <button onclick="showStats()">ğŸ“ˆ æ˜¾ç¤ºç»Ÿè®¡</button>
            <div class="status">
                <strong>è§¦æ‘¸åæ ‡:</strong> <span id="touchCoords">ç­‰å¾…è§¦æ‘¸...</span>
            </div>
        </div>
        
        <div class="code-info">
            <h3>ğŸ“ ä»£ç å¯¹æ¯”</h3>
            <p><strong>åŸå§‹ç‰ˆæœ¬:</strong> 457è¡Œï¼ŒåŒ…å«å¤æ‚çš„é”™è¯¯å¤„ç†å’Œå¤‡ç”¨æ–¹æ¡ˆ</p>
            <p><strong>ä¼˜åŒ–ç‰ˆæœ¬:</strong> çº¦150è¡Œï¼Œåˆ é™¤æ— ç”¨é€»è¾‘ï¼Œä¿æŒæ ¸å¿ƒåŠŸèƒ½</p>
            <p><strong>ä¼˜åŒ–æ•ˆæœ:</strong> ä»£ç å‡å°‘çº¦65%ï¼Œé€»è¾‘æ›´æ¸…æ™°ï¼Œç»´æŠ¤æ€§æ›´å¥½</p>
        </div>
    </div>

    <script>
        // æ¨¡æ‹ŸæŠ–éŸ³å°æ¸¸æˆç¯å¢ƒ
        if (typeof tt === 'undefined') {
            console.log('ğŸ”§ æ¨¡æ‹ŸæŠ–éŸ³å°æ¸¸æˆç¯å¢ƒ...');
            window.tt = {
                getSystemInfoSync: () => ({
                    windowWidth: window.innerWidth,
                    windowHeight: window.innerHeight,
                    pixelRatio: window.devicePixelRatio || 1
                }),
                createCanvas: () => document.createElement('canvas'),
                onTouchStart: (callback) => {
                    document.addEventListener('touchstart', callback);
                    document.addEventListener('mousedown', (e) => {
                        const touch = {
                            touches: [{
                                clientX: e.clientX,
                                clientY: e.clientY
                            }]
                        };
                        callback(touch);
                    });
                },
                setInnerAudioOption: (options) => {
                    console.log('ğŸ”‡ éŸ³é¢‘è®¾ç½®:', options);
                }
            };
        }
        
        // æ¸¸æˆçŠ¶æ€ç®¡ç†
        let gameInstance = null;
        let currentVersion = 'optimized'; // 'original' æˆ– 'optimized'
        
        // å¯åŠ¨æ¸¸æˆ
        function startGame() {
            try {
                // æ¸…ç©ºæ¸¸æˆåŒºåŸŸ
                const gameArea = document.querySelector('.game-canvas');
                gameArea.innerHTML = '';
                
                // æ ¹æ®ç‰ˆæœ¬åˆ›å»ºæ¸¸æˆå®ä¾‹
                if (currentVersion === 'optimized') {
                    gameInstance = new DebugGame();
                } else {
                    // è¿™é‡Œå¯ä»¥åŠ è½½åŸå§‹ç‰ˆæœ¬
                    console.log('ğŸ”„ åˆ‡æ¢åˆ°åŸå§‹ç‰ˆæœ¬');
                }
                
                // æ›´æ–°çŠ¶æ€
                document.getElementById('gameStatus').textContent = `æ¸¸æˆè¿è¡Œä¸­ (${currentVersion})`;
                
                console.log(`âœ… ${currentVersion}ç‰ˆæœ¬å¯åŠ¨æˆåŠŸ`);
                
            } catch (error) {
                console.error('âŒ æ¸¸æˆå¯åŠ¨å¤±è´¥:', error);
                document.getElementById('gameStatus').textContent = 'å¯åŠ¨å¤±è´¥: ' + error.message;
            }
        }
        
        // é‡å¯æ¸¸æˆ
        function restartGame() {
            if (gameInstance) {
                gameInstance = null;
            }
            setTimeout(startGame, 100);
        }
        
        // åˆ‡æ¢ç‰ˆæœ¬
        function switchVersion() {
            currentVersion = currentVersion === 'optimized' ? 'original' : 'optimized';
            console.log(`ğŸ”„ åˆ‡æ¢åˆ°${currentVersion}ç‰ˆæœ¬`);
            restartGame();
        }
        
        // æ¸…ç©ºæ§åˆ¶å°
        function clearConsole() {
            console.clear();
            console.log('ğŸ§¹ æ§åˆ¶å°å·²æ¸…ç©º');
        }
        
        // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
        function showStats() {
            const stats = `
ğŸ“Š ä¼˜åŒ–ç‰ˆè°ƒè¯•æ¸¸æˆç»Ÿè®¡ï¼š

ğŸ¯ ä»£ç ä¼˜åŒ–ï¼š
   â€¢ åŸå§‹ç‰ˆæœ¬ï¼š457è¡Œ
   â€¢ ä¼˜åŒ–ç‰ˆæœ¬ï¼šçº¦150è¡Œ
   â€¢ ä»£ç å‡å°‘ï¼šçº¦65%

ğŸ”§ ä¸»è¦ä¼˜åŒ–ï¼š
   â€¢ åˆ é™¤å¤æ‚çš„Canvasæ·»åŠ é€»è¾‘
   â€¢ ç®€åŒ–è§¦æ‘¸äº‹ä»¶å¤„ç†
   â€¢ åˆ é™¤æ— ç”¨çš„é”™è¯¯å¤„ç†
   â€¢ ç®€åŒ–éŸ³é¢‘ç¦ç”¨é€»è¾‘
   â€¢ åˆ é™¤å†—ä½™è°ƒè¯•ä»£ç 

âœ… ä¿æŒåŠŸèƒ½ï¼š
   â€¢ æ¸¸æˆæ ¸å¿ƒé€»è¾‘
   â€¢ è§¦æ‘¸å“åº”
   â€¢ æ¸²æŸ“ç³»ç»Ÿ
   â€¢ è°ƒè¯•ä¿¡æ¯æ˜¾ç¤º

ğŸ’¡ ä¼˜åŒ–æ•ˆæœï¼š
   â€¢ ä»£ç æ›´æ˜“è¯»
   â€¢ ç»´æŠ¤æ€§æ›´å¥½
   â€¢ æ€§èƒ½ç•¥æœ‰æå‡
   â€¢ è°ƒè¯•æ›´ç®€å•
            `;
            console.log(stats);
            alert('ç»Ÿè®¡ä¿¡æ¯å·²è¾“å‡ºåˆ°æ§åˆ¶å°');
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåå¯åŠ¨æ¸¸æˆ
        window.addEventListener('load', () => {
            console.log('ğŸ“± é¡µé¢åŠ è½½å®Œæˆï¼Œå¯åŠ¨ä¼˜åŒ–ç‰ˆæ¸¸æˆ...');
            startGame();
            
            // ç›‘å¬è§¦æ‘¸åæ ‡æ›´æ–°
            setInterval(() => {
                if (gameInstance && gameInstance.lastTouchX !== undefined) {
                    document.getElementById('touchCoords').textContent = 
                        `${gameInstance.lastTouchX}, ${gameInstance.lastTouchY}`;
                }
            }, 100);
        });
        
        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'r':
                case 'R':
                    restartGame();
                    break;
                case 's':
                case 'S':
                    switchVersion();
                    break;
                case 'c':
                case 'C':
                    clearConsole();
                    break;
                case 'i':
                case 'I':
                    showStats();
                    break;
            }
        });
    </script>
    
    <!-- å¯¼å…¥ä¼˜åŒ–ç‰ˆæ¸¸æˆè„šæœ¬ -->
    <script src="debug_game_optimized.js"></script>
</body>
</html>
